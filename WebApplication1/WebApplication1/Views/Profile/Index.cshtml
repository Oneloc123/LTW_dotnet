@model WebApplication1.Models.UserEdit.ProfileEditViewModel
@{
    ViewData["Title"] = "Hồ sơ cá nhân";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mt-5">
    <div class="row">

        <!-- ===== Sidebar ===== -->
        <div class="col-md-4">
            <div class="card text-center shadow-sm">
                <div class="card-body">

                    <!-- Avatar -->
                    <div class="profile-avatar">
                        <img src="@(string.IsNullOrEmpty(Model.CurrentAvatarUrl)
                                     ? "/images/default-avatar.png"
                                     : Model.CurrentAvatarUrl)"
                             alt="Avatar"
                             style="width:120px;height:120px;border-radius:50%;object-fit:cover" />
                    </div>


                    <h5 class="card-title">@Model.FullName</h5>
                    <p class="text-muted">@Model.Email</p>

                    <a href="/Profile/Edit" class="btn btn-outline-primary btn-sm">
                        Chỉnh sửa hồ sơ
                    </a>
                </div>
            </div>
        </div>

        <!-- ===== Main content ===== -->
        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-header bg-white">
                    <h5 class="mb-0">Thông tin cá nhân</h5>
                </div>

                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold">Tên đăng nhập</div>
                        <div class="col-sm-8">@Model.Username</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold">Họ và tên</div>
                        <div class="col-sm-8">@Model.FullName</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold">Email</div>
                        <div class="col-sm-8">@Model.Email</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold">Số điện thoại</div>
                        <div class="col-sm-8">@Model.PhoneNumber</div>
                    </div>


                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold">Địa chỉ</div>
                        <div class="col-sm-8">@Model.FullAddress</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-sm-4 fw-bold">Ngày sinh</div>
                        <div class="col-sm-8">
                            @(Model.DateOfBirth?.ToString("dd/MM/yyyy") ?? "Chưa cập nhật")
                        </div>
                    </div>

                    <hr />

                    <div class="d-flex gap-2">
                        <a asp-action="Edit" class="btn btn-outline-primary btn-sm">
                            Chỉnh sửa hồ sơ
                        </a>

                        <a href="/Profile/ChangePassword" class="btn btn-outline-secondary">
                            Đổi mật khẩu
                        </a>
                    </div>
                </div>
            </div>


            <div class="card shadow-sm mt-4">
                <div class="card-header bg-white">
                    <ul class="nav nav-tabs card-header-tabs" role="tablist">
                        <li class="nav-item">
                            <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#blogs">
                                📝 Blog đã viết
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#orders">
                                🛒 Đơn hàng
                            </button>
                        </li>
                        <li class="nav-item">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#reviews">
                                ⭐ Đánh giá
                            </button>
                        </li>
                    </ul>
                </div>

                <div class="card-body tab-content">

                    <!-- ===== Blogs ===== -->
                    <div class="tab-pane fade show active" id="blogs">
                        @if (!Model.Blogs.Any())
                        {
                            <p class="text-muted">Bạn chưa viết blog nào.</p>
                        }
                        else
                        {
                            <ul class="list-group list-group-flush">
                                @foreach (var blog in Model.Blogs)
                                {
                                    <li class="list-group-item">
                                        <a href="/Blog/Details/@blog.Id" class="fw-bold">
                                            @blog.Title
                                        </a>
                                        <div class="text-muted small">
                                            @blog.CreatedAt.ToString("dd/MM/yyyy")
                                        </div>
                                    </li>
                                }
                            </ul>
                        }
                    </div>

                    <!-- ===== Orders ===== -->
                    <div class="tab-pane fade" id="orders">
                        @if (!Model.Orders.Any())
                        {
                            <p class="text-muted">Chưa có đơn hàng nào.</p>
                        }
                        else
                        {
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Mã đơn</th>
                                        <th>Ngày</th>
                                        <th>Tổng</th>
                                        <th>Trạng thái</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var o in Model.Orders)
                                    {
                                        <tr>
                                            <td>#@o.Id</td>
                                            <td>@o.CreatedAt.ToString("dd/MM/yyyy")</td>
                                            @*<td>@o.TotalPrice.ToString("N0") đ</td> *@
                                            <td>
                                                <span class="badge bg-info">@o.Status</span>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                    </div>

                    <!-- ===== Reviews ===== -->
                    @* <div class="tab-pane fade" id="reviews">
                        @if (!Model.Reviews.Any())
                        {
                            <p class="text-muted">Bạn chưa đánh giá sản phẩm nào.</p>
                        }
                        else
                        {
                            @foreach (var r in Model.Reviews)
                            {
                                <div class="border-bottom pb-2 mb-2">
                                    <div class="fw-bold">@r.ProductName</div>
                                    <div class="text-warning">
                                        @for (int i = 0; i < r.Rating; i++)
                                        {
                                            <i class="bi bi-star-fill"></i>
                                        }
                                    </div>
                                    <div class="small text-muted">@r.CreatedAt.ToString("dd/MM/yyyy")</div>
                                    <p>@r.Comment</p>
                                </div>
                            }
                        }
                    </div> *@

                </div>
            </div>

        </div>

    </div>
</div>
